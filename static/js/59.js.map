{"version":3,"file":"static/js/59.js","sources":["webpack:///index.vue","webpack:///./src/components/ByuiXvdl/index.vue?be4c","webpack:///./src/components/ByuiXvdl/index.vue","webpack:///./src/components/ByuiXvdl/index.vue?644e","webpack:///./src/components/ByuiXvdl/index.vue?580b"],"sourcesContent":["<template>\n  <canvas :id=\"id\" height=\"450\" width=\"800\"></canvas>\n</template>\n<script>\nconst wkArr = [];\nlet ws;\nexport default {\n  name: \"ByuiXvdl\",\n  props: {\n    url: {\n      type: String,\n      default: \"\",\n    },\n    sessionId: {\n      type: String,\n      default: \"\",\n    },\n  },\n  data() {\n    return {\n      id: this.getUuid(),\n    };\n  },\n  beforeDestroy() {\n    if (typeof wkArr != \"undefined\") {\n      wkArr.forEach((index, item) => {\n        item.postMessage({\n          cmd: \"close\",\n        });\n      });\n    }\n    if (typeof ws != \"undefined\") {\n      ws.close();\n    }\n  },\n  mounted() {\n    this.$nextTick(() => {\n      const canvas = document.getElementById(this.id);\n      this.init_rplay(this.url, canvas, this.sessionId);\n    });\n  },\n  methods: {\n    getUuid() {\n      return \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, function (\n        c\n      ) {\n        const r = (Math.random() * 16) | 0,\n          v = c == \"x\" ? r : (r & 0x3) | 0x8;\n        return v.toString(16);\n      });\n    },\n    init_rplay(url, canvas, initmsg, readycb) {\n      const cxt = canvas.getContext(\"2d\");\n      if (!cxt) return;\n      cxt.imageSmoothingEnabled = true;\n      let cw = canvas.width,\n        ch = canvas.height;\n      let cvs2, cxt2;\n      let imgw, imgh, imgd;\n      const wk = new Worker(\"xvid/worker.js\");\n      wkArr.push(wk);\n      wk.addEventListener(\"message\", function (msg) {\n        switch (msg.data.cmd) {\n          case \"decode_image\":\n            imgd.data.set(new Uint8ClampedArray(msg.data.data));\n            wk.postMessage(\n              {\n                cmd: \"bufback\",\n                data: msg.data.data,\n              },\n              [msg.data.data]\n            );\n            if (cw == imgw && ch == imgh) {\n              cxt.putImageData(imgd, 0, 0);\n            } else {\n              cxt2.putImageData(imgd, 0, 0);\n              cxt.drawImage(cvs2, 0, 0, imgw, imgh, 0, 0, cw, ch);\n            }\n            break;\n          case \"wasmLoaded\":\n            {\n              const ws = new WebSocket(url);\n              ws.binaryType = \"arraybuffer\";\n              ws.onopen = function () {\n                if (initmsg) ws.send(initmsg);\n              };\n              ws.onmessage = function (e) {\n                const rawbuf = e.data;\n                switch (rawbuf.byteLength) {\n                  case 8:\n                    {\n                      const cmdbuf = new Uint32Array(rawbuf);\n                      imgw = cmdbuf[0];\n                      imgh = cmdbuf[1];\n                      imgd = cxt.createImageData(imgw, imgh);\n                      cvs2 = document.createElement(\"canvas\");\n                      cvs2.width = imgw;\n                      cvs2.height = imgh;\n                      cxt2 = cvs2.getContext(\"2d\");\n\n                      wk.postMessage({\n                        cmd: \"init\",\n                        w: imgw,\n                        h: imgh,\n                      });\n                    }\n                    break;\n                  default:\n                    {\n                      wk.postMessage(\n                        {\n                          cmd: \"frame\",\n                          data: rawbuf,\n                        },\n                        [rawbuf]\n                      );\n                    }\n                    break;\n                }\n              };\n              ws.onclose = function () {\n                wk.postMessage({\n                  cmd: \"close\",\n                });\n              };\n\n              ws.update_size = function () {\n                cw = canvas.width;\n                ch = canvas.height;\n                if (cvs2) cxt.drawImage(cvs2, 0, 0, imgw, imgh, 0, 0, cw, ch);\n              };\n              window.addEventListener(\"beforeunload\", () => {\n                ws.close();\n              });\n              if (readycb) readycb(ws);\n            }\n            break;\n          default:\n            break;\n        }\n      });\n    },\n  },\n};\n</script>\n<style lang=\"scss\"></style>\n","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"canvas\", { attrs: { id: _vm.id, height: \"450\", width: \"800\" } })\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=64b4e578&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/_vue-loader@15.9.1@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"D:\\\\Development\\\\WebStormProjects\\\\vue-element-admin-beautiful\\\\node_modules\\\\_vue-hot-reload-api@2.3.4@vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('64b4e578')) {\n      api.createRecord('64b4e578', component.options)\n    } else {\n      api.reload('64b4e578', component.options)\n    }\n    module.hot.accept(\"./index.vue?vue&type=template&id=64b4e578&\", function () {\n      api.rerender('64b4e578', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/components/ByuiXvdl/index.vue\"\nexport default component.exports","import mod from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_babel-loader@8.1.0@babel-loader/lib/index.js!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.1@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_babel-loader@8.1.0@babel-loader/lib/index.js!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.1@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","export * from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js?{\\\"cacheDirectory\\\":\\\"node_modules/.cache/vue-loader\\\",\\\"cacheIdentifier\\\":\\\"5e2061c8-vue-loader-template\\\"}!../../../node_modules/_vue-loader@15.9.1@vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.1@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=template&id=64b4e578&\""],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAFA;AALA;AAUA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAGA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAFA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAHA;AAKA;AACA;AACA;AAAA;AACA;AACA;AAEA;AACA;AAFA;AAMA;AACA;AA7BA;AA+BA;AACA;AAAA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AA5EA;AA8EA;AACA;AApGA;AAnCA;;;;;;;;;;;;ACNA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAiBA;AACA;AACA;;;;;;;;;;;;ACtCA;AAAA;AAAA;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;A","sourceRoot":""}